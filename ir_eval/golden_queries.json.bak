{
    "settings": {
        "prompt": "Evaluate the quality of these search results based on the guidance provided. For each query, assess how well the top results match the positive guidelines and avoid the negative guidelines. Consider whether the system successfully identified relevant content, especially in cases involving character references (e.g., 'you' vs. 'Alex'), relationship dynamics, or specific narrative events.\n\nFor each query, please provide:\n1. A relevance score for each top result (1-5 scale)\n2. Comments on what makes results relevant or irrelevant\n3. Suggestions for improving retrieval quality\n\nPay special attention to the 'user_character' category, which tests the system's ability to connect second-person POV ('your') to the protagonist ('Alex').\n\nNOTE: This file now includes experimental settings for the IR evaluation system. To compare these settings against the control settings in settings.json, run './ir_evaluate' from the nexus directory.",
        "structured_data": false,
        "query": {
            "default_limit": 50,
            "include_vector_results": 50,
            "include_text_results": 50,
            "include_structured_results": 0,
            "chunks_per_query": 50
        },
        "retrieval": {
            "max_results": 50,
            "relevance_threshold": 0.65,
            "entity_boost_factor": 1.2,
            "source_weights": {
                "structured_data": 1.5,
                "vector_search": 0.8,
                "text_search": 1.0
            },
            "vector_normalization": {
                "enabled": false,
                "tiers": [
                    [
                        0.997,
                        0.95
                    ],
                    [
                        0.99,
                        0.9
                    ],
                    [
                        0.97,
                        0.85
                    ],
                    [
                        0.95,
                        0.8
                    ],
                    [
                        0.93,
                        0.75
                    ],
                    [
                        0.91,
                        0.7
                    ],
                    [
                        0.89,
                        0.65
                    ]
                ],
                "low_tier_map_enabled": true,
                "low_tier_threshold": 0.85,
                "low_tier_input_max": 0.89,
                "low_tier_output_min": 0.5,
                "low_tier_output_max": 0.6,
                "below_low_tier_scale_factor": 0.588
            },
            "text_search_base_score": 0.6,
            "text_search_count_bonus": 0.05,
            "text_search_max_score": 0.85,
            "structured_search_char_score": 0.95,
            "structured_search_place_score": 0.9,
            "user_character_focus_boost": {
                "enabled": true,
                "action_patterns": [
                    "you (reach|grab|take|move|walk|run|speak|say|ask|decide)",
                    "your (hands|fingers|eyes|body|mind) (feel|sense|detect)",
                    "you (feel|think|decide|realize|understand|consider)"
                ],
                "emotional_patterns": [
                    "you (feel|experience) (a|an|the) (surge|wave|sense) of",
                    "your heart (races|pounds|skips)",
                    "(fear|hope|anger|joy|sadness) (fills|grips|washes over) you"
                ],
                "knowledge_terms": [
                    "neural implant",
                    "connection to the network",
                    "augmentations"
                ],
                "action_pattern_weight": 0.02,
                "emotional_pattern_weight": 0.03,
                "knowledge_term_weight": 0.05,
                "max_boost": 0.15
            },
            "hybrid_search": {
                "enabled": true,
                "vector_weight_default": 0.6,
                "text_weight_default": 0.4,
                "weights_by_query_type": {
                    "character": {
                        "vector": 0.8,
                        "text": 0.2
                    },
                    "relationship": {
                        "vector": 0.8,
                        "text": 0.2
                    },
                    "event": {
                        "vector": 0.5,
                        "text": 0.5
                    },
                    "location": {
                        "vector": 0.55,
                        "text": 0.45
                    },
                    "theme": {
                        "vector": 0.85,
                        "text": 0.15
                    },
                    "general": {
                        "vector": 0.6,
                        "text": 0.4
                    }
                },
                "temporal_boost_factors": {
                    "character": 0.35,
                    "relationship": 0.45,
                    "event": 0.4,
                    "location": 0.25,
                    "theme": 0.3,
                    "general": 0.4
                },
                "use_query_type_weights": true,
                "use_query_type_temporal_factors": true,
                "target_model": "inf-retriever-v1-1.5b",
                "temporal_boost_factor": 0.6
            },
            "cross_encoder_reranking": {
                "enabled": true,
                "model_path": "/Users/pythagor/nexus/models/naver-trecdl22-crossencoder-debertav3",
                "blend_weight": 0.35,
                "top_k": 30,
                "batch_size": 16,
                "use_sliding_window": true,
                "window_size": 512,
                "window_overlap": 256,
                "weights_by_query_type": {
                    "character": 0.25,
                    "relationship": 0.25,
                    "event": 0.35,
                    "location": 0.35,
                    "theme": 0.2,
                    "general": 0.3
                },
                "use_query_type_weights": false,
                "use_8bit": true
            },
            "structured_data_enabled": false
        },
        "models": {
            "bge-large": {
                "is_active": true,
                "local_path": "/Users/pythagor/nexus/models/bge-large-en",
                "remote_path": "BAAI/bge-large-en",
                "dimensions": 1024,
                "weight": 0.2
            },
            "e5-large": {
                "is_active": true,
                "local_path": "/Users/pythagor/nexus/models/e5-large-v2",
                "remote_path": "intfloat/e5-large-v2",
                "dimensions": 1024,
                "weight": 0.3
            },
            "bge-small-custom": {
                "is_active": false,
                "local_path": "/Users/pythagor/nexus/models/bge_small_finetuned_20250320_153654",
                "remote_path": null,
                "dimensions": 384,
                "weight": 0.0
            },
            "inf-retriever-v1-1.5b": {
                "is_active": true,
                "local_path": "/Users/pythagor/nexus/models/inf-retriever-v1-1.5b",
                "remote_path": "infly/inf-retriever-v1-1.5b",
                "dimensions": 1536,
                "weight": 0.5
            }
        }
    }
}